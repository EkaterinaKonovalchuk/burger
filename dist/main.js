"use strict";var humburger=function(e){var t=document.querySelector(e.button),n=document.querySelector(e.menu),o=document.querySelector("body");flag=!1;var i=function(e){t.classList.toggle("is-active"),n.classList.toggle("is-active"),o.classList.toggle("body-active-menu"),flag?flag=!1:flag=!0};return n.addEventListener("click",function(e){target=e.target,"menu__item-link"==target.className&&i()}),document.addEventListener("keydown",function(e){27==e.keyCode&&flag&&i()}),{init:function(){t.addEventListener("click",i)}}}({button:"#hamburger-menu-link",menu:"#hamburger-menu"});humburger.init(),$(document).ready(function(){var n=$(".menu_accordeon-text__title"),o="menu__accordeon-item_active";n.click(function(e){e.preventDefault();var t=$(this).parent();t.hasClass(o)?t.removeClass(o):(n.parent().removeClass(o),t.addClass(o))})}),$(document).ready(function(){var n=$(".accordeon__trigger"),o="accordeon__item_is-active";n.click(function(e){e.preventDefault();var t=$(this).parent();t.hasClass(o)?t.removeClass(o):(n.parent().removeClass(o),t.addClass(o))})});var modalPopup=function(){for(var e=document.querySelectorAll("#reviews__modal"),t=document.querySelector("#modal-template").innerHTML,n=document.querySelector("#form-template").innerHTML,o=r(t),i=r(n),a=0;a<e.length;a++)e[a].addEventListener("click",function(e){event.preventDefault();var t=e.currentTarget.closest(".reviews__item-hover").querySelector(".reviews__text").innerHTML,n=e.currentTarget.closest(".reviews__item-hover").querySelector(".reviews__title").innerHTML;o.setContent(t,n),o.open()});function r(e){var t=document.createElement("div");t.className="popup",t.innerHTML=e;var n,o=t.querySelector(".popup__content-text"),i=t.querySelector(".popup__content-title");(n=t.querySelector(".popup__close")?t.querySelector(".popup__close"):t.querySelector(".popup__button")).addEventListener("click",function(e){document.body.removeChild(t)});var a=t.querySelector(".overlay");return a.addEventListener("click",function(e){e.preventDefault(),e.target===a&&n.click()}),{open:function(){document.body.appendChild(t)},close:function(){n.click()},setContent:function(e,t){o.innerHTML=e,i&&(i.innerHTML=t)}}}var l=document.querySelector("#myForm");document.querySelector("#form__btn").addEventListener("click",function(e){if(e.preventDefault(),validateForm(l)){var o=function(e){var t=new FormData;t.append("name",e.elements.name.value),t.append("phone",e.elements.phone.value),t.append("comment",e.elements.comment.value),t.append("to","katy-konovalchu@yandex.ru");var n=new XMLHttpRequest;return n.responseType="json",n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(t),n}(l);o.addEventListener("load",function(){if(400<=o.status){var e="Ошибка ".concat(o.status,". Обратитесь к администратору сервера");i.setContent(e),i.open()}else if(o.response.status){var t=o.response.message;i.setContent(t),i.open()}else{var n=o.response.message;i.setContent(n),i.open()}})}})};function validateForm(e){var t=!0;return validateFiled(e.elements.name)||(t=!1),validateFiled(e.elements.phone)||(t=!1),validateFiled(e.elements.comment)||(t=!1),t}function validateFiled(e){return e.checkValidity()?!(e.nextElementSibling.textContent=""):(e.nextElementSibling.textContent=e.validationMessage,!1)}modalPopup(),ymaps.ready(init);var video,durationControl,soundControl,intervalId,placemarks=[{latitude:59.97,longitude:30.31,hintContent:"ул.Литераторов, д. 10",balloonContent:"ул.Литераторов, д. 10"},{latitude:59.94,longitude:30.25,hintContent:"Малый проспект В О, д. 64",balloonContent:"Малый проспект В О, д. 64"},{latitude:59.93,longitude:30.34,hintContent:"наб. реки Фонтанки, д. 56",balloonContent:"наб. реки Фонтанки, д. 56"}];function init(){var n=new ymaps.Map("map",{center:[59.94,30.32],zoom:12,controls:["zoomControl"],behaviors:["drag"]});placemarks.forEach(function(e){var t=new ymaps.Placemark([e.latitude,e.longitude],{hintContent:e.hintContent,balloonContent:e.balloonContent},{iconLayout:"default#image",iconImageHref:"./img/svg/map-marker.svg",iconImage:[40,57],iconImageOffset:[-23,-57]});n.geoObjects.add(t)})}function playStop(){$(".video__player-img").toggleClass("video__player-img--active"),durationControl.max=video.duration,video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/66)):(video.pause(),clearInterval(intervalId))}function stopInterval(){video.pause(),clearInterval(intervalId)}function setVideoDuration(){video.paused?video.play():video.pause(),video.currentTime=durationControl.value,intervalId=setInterval(updateDuration,1e3/66)}function updateDuration(){durationControl.value=video.currentTime}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel):(soundLevel=video.volume,video.volume=0,soundControl.value=0)}function changeSoundVolume(){video.volume=soundControl.value/10,console.log(video.volume)}$().ready(function(){(video=document.getElementById("player")).addEventListener("click",playStop);for(var e=document.querySelectorAll(".play"),t=0;t<e.length;t++)e[t].addEventListener("click",playStop);document.getElementById("mic").addEventListener("click",soundOf),(durationControl=document.getElementById("durationLevel")).addEventListener("mousedown",stopInterval),durationControl.addEventListener("mouseup",setVideoDuration),durationControl.min=0,durationControl.value=0,(soundControl=document.getElementById("micLevel")).addEventListener("mouseup",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max,video.addEventListener("ended",function(){$(".video__player-img").toggleClass("video__player-img--active"),video.currentTime=0},!1)}),$(document).ready(function(){$(".burger__button-next").on("click",function(e){e.preventDefault(),container=$(".slider"),items=container.find(".slider__item"),activeSlide=$(".slider__item.active"),reqItem=activeSlide.next(),reqIndex=reqItem.index(),list=container.find(".slider__list"),duration=500,reqItem.length&&list.animate({left:100*-reqIndex+"%"},duration,function(){activeSlide.removeClass("active"),reqItem.addClass("active")})}),$(".burger__button-prev").on("click",function(e){e.preventDefault(),container=$(".slider"),items=container.find(".slider__item"),activeSlide=$(".slider__item.active"),reqItem=activeSlide.prev(),reqIndex=reqItem.index(),list=container.find(".slider__list"),duration=500,reqItem.length&&list.animate({left:100*-reqIndex+"%"},duration,function(){activeSlide.removeClass("active"),reqItem.addClass("active")})});var o,n,i,a,r,e=new MobileDetect(window.navigator.userAgent).mobile();o=$(".section"),n=$("#maincontent"),i=!1,a=function(e){if(!i){i=!0,console.log(e);var t=-100*e+"%";console.log(t),o.eq(e).addClass("is-active").siblings().removeClass("is-active"),n.css({transform:"translateY(".concat(t,")"),"-webkit-transform":"translateY(".concat(t,")")}),setTimeout(function(){i=!1,$(".fixed__menu-item").eq(e).addClass(".active").siblings().removeClass("active")},1e3)}},r=function(e){var t,n={activeSection:t=o.filter(".is-active"),nextSection:t.next(),prevSection:t.prev()};"up"==e&&n.nextSection.length&&a(n.nextSection.index()),"down"==e&&n.prevSection.length&&a(n.prevSection.index())},$(".wrapper").on({wheel:function(e){var t=e.originalEvent.deltaY;r(0<t?"up":"down")},touchmove:function(e){return e.preventDefault()}}),e&&$(window).swipe({swipe:function(e,t){r(t)}}),$("[data-scroll-to]").on("click",function(e){e.preventDefault(),a(parseInt($(e.target).data("scroll-to")))})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsiaHVtYnVyZ2VyIiwib3B0aW9ucyIsImJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1lbnUiLCJib2R5IiwiZmxhZyIsIl90b2dnbGVNZW51IiwiZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImluaXQiLCJ0YXJnZXQiLCJjbGFzc05hbWUiLCJrZXlDb2RlIiwiJCIsInJlYWR5IiwiYWNjb3JkIiwiZXZlbnQiLCJjbGljayIsInByZXZlbnREZWZhdWx0IiwicGFyZW50IiwicmVtb3ZlQ2xhc3MiLCJhY3RpdmUiLCJhZGRDbGFzcyIsInRlYW0iLCJ0cmlnZ2VyIiwiaGFzQ2xhc3MiLCJtb2RhbFBvcHVwIiwibW9kYWwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY3JlYXRlTW9kYWwiLCJ0ZW1wbGF0ZU1vZGFsIiwiZm9ybU1vZGFsIiwidGVtcGxhdGVGb3JtIiwiaSIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXJhZ3JhcGgiLCJjdXJyZW50VGFyZ2V0IiwiY2xvc2VzdCIsImlubmVySFRNTCIsImhlYWRsaW5lIiwiY29udGFpbmVyIiwib3BlbiIsInRlbXBsYXRlIiwiY2xvc2VCdG4iLCJjb250ZW50QmxvY2siLCJvdmVybGF5IiwicmVtb3ZlQ2hpbGQiLCJjbG9zZSIsImhlYWRsaW5lQmxvY2siLCJhcHBlbmRDaGlsZCIsInNldENvbnRlbnQiLCJjb250ZW50IiwibmFtZSIsIm15Rm9ybSIsInhociIsImZvcm1EYXRhIiwiYXBwZW5kIiwiZm9ybSIsImVsZW1lbnRzIiwidmFsdWUiLCJwaG9uZSIsImNvbW1lbnQiLCJYTUxIdHRwUmVxdWVzdCIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwicmVxdWVzdCIsInJlc3BvbnNlIiwic3RhdHVzIiwibWVzc2FnZSIsImJ0biIsInZhbGlkYXRlRm9ybSIsInZhbGlkIiwidmFsaWRhdGVGaWxlZCIsImZpZWxkIiwiY2hlY2tWYWxpZGl0eSIsImxvbmdpdHVkZSIsInltYXBzIiwiaGludENvbnRlbnQiLCJiYWxsb29uQ29udGVudCIsInZpZGVvIiwic291bmRDb250cm9sIiwiaW50ZXJ2YWxJZCIsImxhdGl0dWRlIiwiY2VudGVyIiwiYmVoYXZpb3JzIiwicGxhY2VtYXJrcyIsImljb25MYXlvdXQiLCJpY29uSW1hZ2VIcmVmIiwiaWNvbkltYWdlIiwiaWNvbkltYWdlT2Zmc2V0IiwibXlNYXAiLCJNYXAiLCJ6b29tIiwiY29udHJvbHMiLCJvYmoiLCJwbGF5QnV0dG9ucyIsIm1pY0NvbnRyb2wiLCJkdXJhdGlvbkNvbnRyb2wiLCJwbGF5U3RvcCIsInNvdW5kTGV2ZWwiLCJwYXVzZWQiLCJwbGF5Iiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGVEdXJhdGlvbiIsInBhdXNlIiwiY2xlYXJJbnRlcnZhbCIsInN0b3BJbnRlcnZhbCIsImNvbnNvbGUiLCJpdGVtcyIsImN1cnJlbnRUaW1lIiwibGlzdCIsImFjdGl2ZVNsaWRlIiwicmVxSXRlbSIsInNvdW5kT2YiLCJ2b2x1bWUiLCJsb2ciLCJnZXRFbGVtZW50QnlJZCIsIm1pbiIsIm1heCIsIm9uIiwiZmluZCIsIm5leHQiLCJyZXFJbmRleCIsImluZGV4IiwiZHVyYXRpb24iLCJsZW5ndGgiLCJhbmltYXRlIiwibGVmdCIsInByZXYiLCJzZWN0aW9ucyIsInZpc2libGUiLCJpbnNjcm9sbCIsInBlcmZvcm1UcmFuc2l0aW9uIiwic2Nyb2xsVG9TZWN0aW9uIiwiaXNNb2JpbGUiLCJNb2JpbGVEZXRlY3QiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJtb2JpbGUiLCJzZWN0aW9uRXEiLCJwb3NpdGlvbiIsImVxIiwic2libGluZ3MiLCJjc3MiLCJ0cmFuc2Zvcm0iLCJjb25jYXQiLCItd2Via2l0LXRyYW5zZm9ybSIsInNldFRpbWVvdXQiLCJkaXJlY3Rpb24iLCJhY3RpdmVTZWN0aW9uIiwic2VjdGlvbiIsImZpbHRlciIsIm5leHRTZWN0aW9uIiwicHJldlNlY3Rpb24iLCJ3aGVlbCIs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LENBQ0FDLFVBQUEsY0FBQUMsT0FBQUwsRUFBQSxLQUNBTSxvQkFBQSxjQUFBRCxPQUFBTCxFQUFBLE9BR0FPLFdBQUEsV0FDQWpCLEdBQUEsRUFFQXRILEVBQUEscUJBQ0FpSSxHQUFBRixHQUNBdEgsU0FBQSxXQUNBeUgsV0FDQTNILFlBQUEsV0FDQSxPQWlCQWlILEVBQUEsU0FBQWdCLEdBQ0EsSUFWQUMsRUFVQUMsRUFUQSxDQUNBRCxjQUZBQSxFQVVBckIsRUFWQXVCLE9BQUEsY0FHQUMsWUFBQUgsRUFBQTdCLE9BQ0FpQyxZQUFBSixFQUFBdEIsUUFPQSxNQUFBcUIsR0FBQUUsRUFBQUUsWUFBQTVCLFFBQ0FPLEVBQUFtQixFQUFBRSxZQUFBOUIsU0FHQSxRQUFBMEIsR0FBQUUsRUFBQUcsWUFBQTdCLFFBQ0FPLEVBQUFtQixFQUFBRyxZQUFBL0IsVUFLQTlHLEVBQUEsWUFBQTBHLEdBQUEsQ0FDQW9DLE1BQUEsU0FBQXJKLEdBQ0EsSUFBQXNKLEVBQUF0SixFQUFBdUosY0FBQUQsT0FHQXZCLEVBRkEsRUFBQXVCLEVBQUEsS0FBQSxTQUlBRSxVQUFBLFNBQUF4SixHQUFBLE9BQUFBLEVBQUFZLG9CQUVBb0gsR0FDQXpILEVBQUEySCxRQUFBdUIsTUFBQSxDQUNBQSxNQUFBLFNBQUEvSSxFQUFBcUksR0FDQWhCLEVBQUFnQixNQVlBeEksRUFBQSxvQkFBQTBHLEdBQUEsUUFBQSxTQUFBakgsR0FDQUEsRUFBQVksaUJBQ0FrSCxFQUFBNEIsU0FBQW5KLEVBQUFQLEVBQUFJLFFBQUF1SixLQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL3dpbmRvdy5vbmVsb2FkPSBmdW5jdGlvbigpe1xyXG5cclxuLy9odW1idXJnZXJcclxubGV0IGh1bWJ1cmdlciA9IChmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5idXR0b24pO1xyXG4gIGxldCBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLm1lbnUpO1xyXG4gIGxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XHJcblxyXG4gIGZsYWcgPSBmYWxzZTtcclxuICBsZXQgX3RvZ2dsZU1lbnUgPSBmdW5jdGlvbihlKSB7XHJcbiAgICBidXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImlzLWFjdGl2ZVwiKTtcclxuICAgIG1lbnUuY2xhc3NMaXN0LnRvZ2dsZShcImlzLWFjdGl2ZVwiKTtcclxuICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZShcImJvZHktYWN0aXZlLW1lbnVcIik7XHJcblxyXG4gICAgZmxhZyA/IChmbGFnID0gZmFsc2UpIDogKGZsYWcgPSB0cnVlKTtcclxuICB9O1xyXG5cclxuICBsZXQgYWRkTGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XHJcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF90b2dnbGVNZW51KTtcclxuICB9O1xyXG5cclxuICBtZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XHJcbiAgICB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgIGlmICh0YXJnZXQuY2xhc3NOYW1lID09IFwibWVudV9faXRlbS1saW5rXCIpIHtcclxuICAgICAgX3RvZ2dsZU1lbnUoKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgaWYgKGUua2V5Q29kZSA9PSAyNyAmJiBmbGFnKSB7XHJcbiAgICAgIF90b2dnbGVNZW51KCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBpbml0OiBhZGRMaXN0ZW5lcnNcclxuICB9O1xyXG59KSh7XHJcbiAgYnV0dG9uOiBcIiNoYW1idXJnZXItbWVudS1saW5rXCIsXHJcbiAgbWVudTogXCIjaGFtYnVyZ2VyLW1lbnVcIlxyXG59KTtcclxuXHJcbi8qIGJ1dHRvbj0xO1xyXG4gY29uc29sZS5sb2coYnV0dG9uKTtcclxuIGNvbnNvbGUubG9nKG1lbnUpO1xyXG4gICBtZW51Lm9wZW5NZW51KCk7Ki9cclxuaHVtYnVyZ2VyLmluaXQoKTtcclxuXHJcbi8vIH1cclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gIGxldCBhY2NvcmQgPSAkKFwiLm1lbnVfYWNjb3JkZW9uLXRleHRfX3RpdGxlXCIpO1xyXG4gIGxldCBhY3RpdmUgPSBcIm1lbnVfX2FjY29yZGVvbi1pdGVtX2FjdGl2ZVwiO1xyXG5cclxuICBhY2NvcmQuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBsZXQgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuXHJcbiAgICBpZiAocGFyZW50Lmhhc0NsYXNzKGFjdGl2ZSkpIHtcclxuICAgICAgcGFyZW50LnJlbW92ZUNsYXNzKGFjdGl2ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhY2NvcmQucGFyZW50KCkucmVtb3ZlQ2xhc3MoYWN0aXZlKTtcclxuICAgICAgcGFyZW50LmFkZENsYXNzKGFjdGl2ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgbGV0IHRlYW0gPSAkKFwiLmFjY29yZGVvbl9fdHJpZ2dlclwiKTtcclxuICBsZXQgdHJpZ2dlciA9IFwiYWNjb3JkZW9uX19pdGVtX2lzLWFjdGl2ZVwiO1xyXG5cclxuICB0ZWFtLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbGV0IHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcblxyXG4gICAgaWYgKHBhcmVudC5oYXNDbGFzcyh0cmlnZ2VyKSkge1xyXG4gICAgICBwYXJlbnQucmVtb3ZlQ2xhc3ModHJpZ2dlcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0ZWFtLnBhcmVudCgpLnJlbW92ZUNsYXNzKHRyaWdnZXIpO1xyXG4gICAgICBwYXJlbnQuYWRkQ2xhc3ModHJpZ2dlcik7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy9zbGlkZVxyXG4vKmNvbnN0IGxlZnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2xlZnRcIik7XHJcbiAgICBjb25zdCByaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcmlnaHRcIik7XHJcbiAgICBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaXRlbXNcIik7XHJcbiAgICBjb25zdCBtaW5SaWdodCA9IDA7XHJcbiAgICBjb25zdCBjb21wdXRlZCA9IGdldENvbXB1dGVkU3R5bGUoaXRlbXMpO1xyXG4gICAgbGV0IHNsaWRlcldpZHRoID0gIHBhcnNlSW50IChjb21wdXRlZC53aWR0aCk7XHJcbiAgICBcclxuICAgdmFyIHNsaWRlckl0ZW1zQ291bnRlciA9IGl0ZW1zLmNoaWxkcmVuLmxlbmd0aDtcclxuICAgXHJcbiAgICByaWdodC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBsZXQgY3VycmVudFJpZ2h0PSBwYXJzZUludChjb21wdXRlZC5yaWdodCk7XHJcbiAgICAgICAvLyBjb25zb2xlLmxvZyhjb21wdXRlZC5yaWdodCk7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRSaWdodCA8IChzbGlkZXJJdGVtc0NvdW50ZXItMSkqc2xpZGVyV2lkdGgpIHtcclxuICAgICAgICAgIGl0ZW1zLnN0eWxlLnJpZ2h0ID0gY3VycmVudFJpZ2h0ICsgc2xpZGVyV2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxlZnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgICBsZXQgY3VycmVudFJpZ2h0ID0gcGFyc2VJbnQoY29tcHV0ZWQucmlnaHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgaWYgKGN1cnJlbnRSaWdodCA+IDAgKSB7XHJcbiAgICAgICAgICAgIGl0ZW1zLnN0eWxlLnJpZ2h0ID0gY3VycmVudFJpZ2h0IC0gc2xpZGVyV2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuICAgXHJcbiAgKi9cclxuLy9tb2RhbFxyXG5cclxubGV0IG1vZGFsUG9wdXAgPSBmdW5jdGlvbigpe1xyXG4gICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiNyZXZpZXdzX19tb2RhbFwiKTtcclxuICAgIGNvbnN0IHRlbXBsYXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXRlbXBsYXRlXCIpLmlubmVySFRNTDtcclxuICAgIGNvbnN0IHRlbXBsYXRlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS10ZW1wbGF0ZVwiKS5pbm5lckhUTUw7XHJcbiAgICBjb25zdCBtb2RhbCA9IGNyZWF0ZU1vZGFsKHRlbXBsYXRlTW9kYWwpO1xyXG4gICAgY29uc3QgZm9ybU1vZGFsID0gY3JlYXRlTW9kYWwodGVtcGxhdGVGb3JtKTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbi5sZW5ndGg7IGkrKykge1xyXG4gICAgYnV0dG9uW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBsZXQgcGFyYWdyYXBoID0gZS5jdXJyZW50VGFyZ2V0LmNsb3Nlc3QoXCIucmV2aWV3c19faXRlbS1ob3ZlclwiKS5xdWVyeVNlbGVjdG9yKFwiLnJldmlld3NfX3RleHRcIikuaW5uZXJIVE1MO1xyXG4gICAgICAgIGxldCBoZWFkbGluZSA9IGUuY3VycmVudFRhcmdldC5jbG9zZXN0KFwiLnJldmlld3NfX2l0ZW0taG92ZXJcIikucXVlcnlTZWxlY3RvcihcIi5yZXZpZXdzX190aXRsZVwiKS5pbm5lckhUTUw7XHJcblxyXG4gICAgICAgIG1vZGFsLnNldENvbnRlbnQocGFyYWdyYXBoLCBoZWFkbGluZSk7XHJcbiAgICAgICAgbW9kYWwub3BlbigpO1xyXG4gICAgfSk7XHJcbiAgICB9XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVNb2RhbCh0ZW1wbGF0ZSkge1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwicG9wdXBcIjtcclxuICBjb250YWluZXIuaW5uZXJIVE1MID0gdGVtcGxhdGU7XHJcblxyXG4gIGNvbnN0IGNvbnRlbnRCbG9jayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jb250ZW50LXRleHRcIik7XHJcbiAgY29uc3QgaGVhZGxpbmVCbG9jayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jb250ZW50LXRpdGxlXCIpO1xyXG4gIGxldCBjbG9zZUJ0bjtcclxuXHJcbiAgaWYgKGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKSkge1xyXG4gICAgY2xvc2VCdG4gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNsb3NlQnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICB9XHJcbiAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xyXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBvdmVybGF5ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKTtcclxuXHJcbiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoZS50YXJnZXQgPT09IG92ZXJsYXkpIHtcclxuICAgICAgY2xvc2VCdG4uY2xpY2soKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIG9wZW4oKSB7XHJcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuICAgIH0sXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgY2xvc2VCdG4uY2xpY2soKTtcclxuICAgIH0sXHJcbiAgICBzZXRDb250ZW50KGNvbnRlbnQsIG5hbWUpIHtcclxuICAgICAgY29udGVudEJsb2NrLmlubmVySFRNTCA9IGNvbnRlbnQ7XHJcbiAgICAgIGlmIChoZWFkbGluZUJsb2NrKSB7XHJcbiAgICAgICAgaGVhZGxpbmVCbG9jay5pbm5lckhUTUwgPSBuYW1lO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuLy9Gb3JtXHJcbmxldCBteUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI215Rm9ybVwiKTtcclxuY29uc3QgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtX19idG5cIik7XHJcblxyXG5mdW5jdGlvbiBhamF4Rm9ybSAoZm9ybSkge1xyXG4gIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gIGZvcm1EYXRhLmFwcGVuZChcIm5hbWVcIiwgZm9ybS5lbGVtZW50cy5uYW1lLnZhbHVlKTtcclxuICBmb3JtRGF0YS5hcHBlbmQoXCJwaG9uZVwiLCBmb3JtLmVsZW1lbnRzLnBob25lLnZhbHVlKTtcclxuICBmb3JtRGF0YS5hcHBlbmQoXCJjb21tZW50XCIsIGZvcm0uZWxlbWVudHMuY29tbWVudC52YWx1ZSk7XHJcbiAgZm9ybURhdGEuYXBwZW5kKFwidG9cIiwgXCJrYXR5LWtvbm92YWxjaHVAeWFuZGV4LnJ1XCIpO1xyXG5cclxuICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICB4aHIucmVzcG9uc2VUeXBlID0gXCJqc29uXCI7XHJcbiAgeGhyLm9wZW4oXCJQT1NUXCIsIFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIpO1xyXG4gIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1SZXF1ZXN0ZWQtV2l0aFwiLCBcIlhNTEh0dHBSZXF1ZXN0XCIpO1xyXG4gIHhoci5zZW5kKGZvcm1EYXRhKTtcclxuXHJcbiAgcmV0dXJuIHhocjtcclxufTtcclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdEZvcm0gKGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5pZiAodmFsaWRhdGVGb3JtKG15Rm9ybSkpIHtcclxuICB2YXIgcmVxdWVzdCA9IGFqYXhGb3JtKG15Rm9ybSk7XHJcbiAgXHJcbiAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XHJcbiAgICBpZiAocmVxdWVzdC5zdGF0dXMgPj0gNDAwKSB7XHJcbiAgICAgIGxldCBjb250ZW50ID0gYNCe0YjQuNCx0LrQsCAke3JlcXVlc3Quc3RhdHVzfS4g0J7QsdGA0LDRgtC40YLQtdGB0Ywg0Log0LDQtNC80LjQvdC40YHRgtGA0LDRgtC+0YDRgyDRgdC10YDQstC10YDQsGA7XHJcbiAgICAgIGZvcm1Nb2RhbC5zZXRDb250ZW50KGNvbnRlbnQpO1xyXG4gICAgICBmb3JtTW9kYWwub3BlbigpO1xyXG4gICAgfSBlbHNlIGlmIChyZXF1ZXN0LnJlc3BvbnNlLnN0YXR1cykge1xyXG4gICAgICBsZXQgY29udGVudCA9IHJlcXVlc3QucmVzcG9uc2UubWVzc2FnZTtcclxuICAgICAgZm9ybU1vZGFsLnNldENvbnRlbnQoY29udGVudCk7XHJcbiAgICAgIGZvcm1Nb2RhbC5vcGVuKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgY29udGVudCA9IHJlcXVlc3QucmVzcG9uc2UubWVzc2FnZTtcclxuICAgICAgZm9ybU1vZGFsLnNldENvbnRlbnQoY29udGVudCk7XHJcbiAgICAgIGZvcm1Nb2RhbC5vcGVuKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuIFxyXG59O1xyXG5cclxuYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzdWJtaXRGb3JtKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVGb3JtKGZvcm0pIHtcclxuICBsZXQgdmFsaWQgPSB0cnVlO1xyXG5cclxuICBpZiAoIXZhbGlkYXRlRmlsZWQoZm9ybS5lbGVtZW50cy5uYW1lKSkge1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGlmICghdmFsaWRhdGVGaWxlZChmb3JtLmVsZW1lbnRzLnBob25lKSkge1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGlmICghdmFsaWRhdGVGaWxlZChmb3JtLmVsZW1lbnRzLmNvbW1lbnQpKSB7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHZhbGlkO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZUZpbGVkKGZpZWxkKSB7XHJcbiAgaWYgKCFmaWVsZC5jaGVja1ZhbGlkaXR5KCkpIHtcclxuICAgIGZpZWxkLm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudCA9IGZpZWxkLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBmaWVsZC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG5cclxubW9kYWxQb3B1cCgpO1xyXG5cclxuLy9tYXBcclxuXHJcbnltYXBzLnJlYWR5KGluaXQpO1xyXG5cclxudmFyIHBsYWNlbWFya3MgPSBbXHJcbiAge1xyXG4gICAgbGF0aXR1ZGU6IDU5Ljk3LFxyXG4gICAgbG9uZ2l0dWRlOiAzMC4zMSxcclxuICAgIGhpbnRDb250ZW50OiBcItGD0Lsu0JvQuNGC0LXRgNCw0YLQvtGA0L7Qsiwg0LQuIDEwXCIsXHJcbiAgICBiYWxsb29uQ29udGVudDogXCLRg9C7LtCb0LjRgtC10YDQsNGC0L7RgNC+0LIsINC0LiAxMFwiXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbGF0aXR1ZGU6IDU5Ljk0LFxyXG4gICAgbG9uZ2l0dWRlOiAzMC4yNSxcclxuICAgIGhpbnRDb250ZW50OiBcItCc0LDQu9GL0Lkg0L/RgNC+0YHQv9C10LrRgiDQkiDQniwg0LQuIDY0XCIsXHJcbiAgICBiYWxsb29uQ29udGVudDogXCLQnNCw0LvRi9C5INC/0YDQvtGB0L/QtdC60YIg0JIg0J4sINC0LiA2NFwiXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbGF0aXR1ZGU6IDU5LjkzLFxyXG4gICAgbG9uZ2l0dWRlOiAzMC4zNCxcclxuICAgIGhpbnRDb250ZW50OiBcItC90LDQsS4g0YDQtdC60Lgg0KTQvtC90YLQsNC90LrQuCwg0LQuIDU2XCIsXHJcbiAgICBiYWxsb29uQ29udGVudDogXCLQvdCw0LEuINGA0LXQutC4INCk0L7QvdGC0LDQvdC60LgsINC0LiA1NlwiXHJcbiAgfVxyXG5dO1xyXG5mdW5jdGlvbiBpbml0KCkge1xyXG4gIHZhciBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xyXG4gICAgY2VudGVyOiBbNTkuOTQsIDMwLjMyXSxcclxuICAgIHpvb206IDEyLFxyXG4gICAgY29udHJvbHM6IFtcInpvb21Db250cm9sXCJdLFxyXG4gICAgYmVoYXZpb3JzOiBbXCJkcmFnXCJdXHJcbiAgfSk7XHJcblxyXG4gIHBsYWNlbWFya3MuZm9yRWFjaChmdW5jdGlvbihvYmopIHtcclxuICAgIHZhciBwbGFjZW1hcmsgPSBuZXcgeW1hcHMuUGxhY2VtYXJrKFxyXG4gICAgICBbb2JqLmxhdGl0dWRlLCBvYmoubG9uZ2l0dWRlXSxcclxuICAgICAge1xyXG4gICAgICAgIGhpbnRDb250ZW50OiBvYmouaGludENvbnRlbnQsXHJcbiAgICAgICAgYmFsbG9vbkNvbnRlbnQ6IG9iai5iYWxsb29uQ29udGVudFxyXG4gICAgICB9LFxyXG5cclxuICAgICAge1xyXG4gICAgICAgIGljb25MYXlvdXQ6IFwiZGVmYXVsdCNpbWFnZVwiLFxyXG4gICAgICAgIGljb25JbWFnZUhyZWY6IFwiLi9pbWcvc3ZnL21hcC1tYXJrZXIuc3ZnXCIsXHJcbiAgICAgICAgaWNvbkltYWdlOiBbNDAsIDU3XSxcclxuICAgICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMjMsIC01N11cclxuICAgICAgfVxyXG4gICAgKTtcclxuICAgIG15TWFwLmdlb09iamVjdHMuYWRkKHBsYWNlbWFyayk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vcGxheWVyXHJcblxyXG5sZXQgdmlkZW87XHJcbmxldCBkdXJhdGlvbkNvbnRyb2w7XHJcbmxldCBzb3VuZENvbnRyb2w7XHJcbmxldCBpbnRlcnZhbElkO1xyXG5cclxuJCgpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gIHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIik7XHJcbiAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHBsYXlTdG9wKTtcclxuXHJcbiAgbGV0IHBsYXlCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wbGF5XCIpO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGxheUJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgIHBsYXlCdXR0b25zW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBwbGF5U3RvcCk7XHJcbiAgfVxyXG5cclxuICBsZXQgbWljQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWljXCIpO1xyXG4gIG1pY0NvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNvdW5kT2YpO1xyXG5cclxuICBkdXJhdGlvbkNvbnRyb2wgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImR1cmF0aW9uTGV2ZWxcIik7XHJcbiAgZHVyYXRpb25Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgc3RvcEludGVydmFsKTtcclxuICBkdXJhdGlvbkNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgc2V0VmlkZW9EdXJhdGlvbik7XHJcblxyXG4gIGR1cmF0aW9uQ29udHJvbC5taW4gPSAwO1xyXG4gIGR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IDA7XHJcblxyXG4gIHNvdW5kQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWljTGV2ZWxcIik7XHJcbiAgc291bmRDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGNoYW5nZVNvdW5kVm9sdW1lKTtcclxuXHJcbiAgc291bmRDb250cm9sLm1pbiA9IDA7XHJcbiAgc291bmRDb250cm9sLm1heCA9IDEwO1xyXG5cclxuICBzb3VuZENvbnRyb2wudmFsdWUgPSBzb3VuZENvbnRyb2wubWF4O1xyXG5cclxuICB2aWRlby5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgXCJlbmRlZFwiLFxyXG4gICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICQoXCIudmlkZW9fX3BsYXllci1pbWdcIikudG9nZ2xlQ2xhc3MoXCJ2aWRlb19fcGxheWVyLWltZy0tYWN0aXZlXCIpO1xyXG4gICAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbiAgICB9LFxyXG4gICAgZmFsc2VcclxuICApO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHBsYXlTdG9wKCkge1xyXG4gICQoXCIudmlkZW9fX3BsYXllci1pbWdcIikudG9nZ2xlQ2xhc3MoXCJ2aWRlb19fcGxheWVyLWltZy0tYWN0aXZlXCIpO1xyXG4gIGR1cmF0aW9uQ29udHJvbC5tYXggPSB2aWRlby5kdXJhdGlvbjtcclxuXHJcbiAgaWYgKHZpZGVvLnBhdXNlZCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKHVwZGF0ZUR1cmF0aW9uLCAxMDAwIC8gNjYpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0b3BJbnRlcnZhbCgpIHtcclxuICB2aWRlby5wYXVzZSgpO1xyXG4gIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFZpZGVvRHVyYXRpb24oKSB7XHJcbiAgaWYgKHZpZGVvLnBhdXNlZCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gIH1cclxuICB2aWRlby5jdXJyZW50VGltZSA9IGR1cmF0aW9uQ29udHJvbC52YWx1ZTtcclxuICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodXBkYXRlRHVyYXRpb24sIDEwMDAgLyA2Nik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUR1cmF0aW9uKCkge1xyXG4gIGR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IHZpZGVvLmN1cnJlbnRUaW1lO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzb3VuZE9mKCkge1xyXG4gIGlmICh2aWRlby52b2x1bWUgPT09IDApIHtcclxuICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kTGV2ZWw7XHJcbiAgICBzb3VuZENvbnRyb2wudmFsdWUgPSBzb3VuZExldmVsICogMTA7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNvdW5kTGV2ZWwgPSB2aWRlby52b2x1bWU7XHJcbiAgICB2aWRlby52b2x1bWUgPSAwO1xyXG4gICAgc291bmRDb250cm9sLnZhbHVlID0gMDtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVNvdW5kVm9sdW1lKCkge1xyXG4gIC8qXHJcbiAgICAgICAg0KHQsi3QstC+IHZvbHVtZSDQvNC+0LbQtdGCINC/0YDQuNC90LjQvNCw0YLRjCDQt9C90LDRh9C10L3QuNGPINC+0YIgMCDQtNC+IDFcclxuICAgICAgICDQlNC10LvQuNC8INC90LAgMTAg0LTQu9GPINGC0L7Qs9C+INGH0YLQviDQsdGLLCDQsdGL0LvQsCDQstC+0LfQvNC+0LbQvdC+0YHRgtGMINCx0L7Qu9C10LUg0YLQvtGH0L3QvtC5INGA0LXQs9GD0LvQuNGA0L7QstC60Lgg0LLQuNC00LXQvi4gXHJcbiAgICAgICAgIHZpZGVvLnZvbHVtZSAwIDAuMSAwLjIgMC4zIDAuNCAwLjUgMC42IDAuNyAwLjggMC45ICAxIFxyXG4gICBzb3VuZENvbnRyb2wudmFsdWUgMCAgIDEgICAyICAgMyAgIDQgICA1ICAgNiAgIDcgICA4ICAgOSAgMTBcclxuICAgICAgICAqL1xyXG5cclxuICB2aWRlby52b2x1bWUgPSBzb3VuZENvbnRyb2wudmFsdWUgLyAxMDtcclxuICBjb25zb2xlLmxvZyh2aWRlby52b2x1bWUpO1xyXG59XHJcbiIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcblx0JCgnLmJ1cmdlcl9fYnV0dG9uLW5leHQnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRjb250YWluZXIgPSAkKFwiLnNsaWRlclwiKTtcclxuXHJcblx0XHRpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9faXRlbVwiKSxcclxuXHJcblx0XHRcdGFjdGl2ZVNsaWRlID0gJCgnLnNsaWRlcl9faXRlbS5hY3RpdmUnKSxcclxuXHJcblx0XHRcdHJlcUl0ZW0gPSBhY3RpdmVTbGlkZS5uZXh0KCksXHJcblx0XHRcdHJlcUluZGV4ID0gcmVxSXRlbS5pbmRleCgpLFxyXG5cdFx0XHRsaXN0ID0gY29udGFpbmVyLmZpbmQoXCIuc2xpZGVyX19saXN0XCIpLFxyXG5cdFx0XHRkdXJhdGlvbiA9IDUwMDtcclxuXHJcblx0XHRpZiAocmVxSXRlbS5sZW5ndGgpIHtcclxuXHRcdFx0bGlzdC5hbmltYXRlKHtcclxuXHRcdFx0XHQnbGVmdCc6IC1yZXFJbmRleCAqIDEwMCArICclJ1xyXG5cdFx0XHR9LCBkdXJhdGlvbiwgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGFjdGl2ZVNsaWRlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0XHRyZXFJdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0fSlcclxuXHRcdH1cclxuXHJcblxyXG5cclxuXHR9KTtcclxuXHJcblxyXG5cdFxyXG5cdCQoJy5idXJnZXJfX2J1dHRvbi1wcmV2Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0Y29udGFpbmVyID0gJChcIi5zbGlkZXJcIik7XHJcblxyXG5cdFx0aXRlbXMgPSBjb250YWluZXIuZmluZChcIi5zbGlkZXJfX2l0ZW1cIiksXHJcblxyXG5cdFx0XHRhY3RpdmVTbGlkZSA9ICQoJy5zbGlkZXJfX2l0ZW0uYWN0aXZlJyksXHJcblxyXG5cdFx0XHRyZXFJdGVtID0gYWN0aXZlU2xpZGUucHJldigpLFxyXG5cdFx0XHRyZXFJbmRleCA9IHJlcUl0ZW0uaW5kZXgoKSxcclxuXHRcdFx0bGlzdCA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9fbGlzdFwiKSxcclxuXHRcdFx0ZHVyYXRpb24gPSA1MDA7XHJcblxyXG5cdFx0aWYgKHJlcUl0ZW0ubGVuZ3RoKSB7XHJcblx0XHRcdGxpc3QuYW5pbWF0ZSh7XHJcblx0XHRcdFx0J2xlZnQnOiAtcmVxSW5kZXggKiAxMDAgKyAnJSdcclxuXHRcdFx0fSwgZHVyYXRpb24sIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRhY3RpdmVTbGlkZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdFx0cmVxSXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdH0pXHJcblx0XHR9XHJcblxyXG5cclxuXHJcblx0fSk7XHJcblxyXG5cclxuXHRcclxudmFyIG1kID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCksXHJcblx0aXNNb2JpbGUgPSBtZC5tb2JpbGUoKTtcclxuXHRsZXQgT25lUGFnZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRcclxuXHRcdGNvbnN0IHNlY3Rpb25zID0gJChcIi5zZWN0aW9uXCIpO1xyXG5cdFx0Y29uc3QgdmlzaWJsZSA9ICQoJyNtYWluY29udGVudCcpO1xyXG5cclxuXHRcdGxldCBpbnNjcm9sbCA9IGZhbHNlO1xyXG5cclxuXHRcdGxldCBwZXJmb3JtVHJhbnNpdGlvbiA9IGZ1bmN0aW9uIChzZWN0aW9uRXEpIHtcclxuICAgICAgICAgaWYgKCFpbnNjcm9sbCl7XHJcblx0XHRcdCBpbnNjcm9sbCA9IHRydWU7XHJcblx0XHQgXHJcbmNvbnNvbGUubG9nKHNlY3Rpb25FcSk7XHJcblxyXG5cdFx0XHRsZXQgcG9zaXRpb24gPSBzZWN0aW9uRXEgKiAtMTAwICsgJyUnO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhwb3NpdGlvbik7XHJcblx0XHRcdHNlY3Rpb25zXHJcblx0XHRcdC5lcShzZWN0aW9uRXEpXHJcblx0XHRcdC5hZGRDbGFzcyhcImlzLWFjdGl2ZVwiKVxyXG5cdFx0XHQuc2libGluZ3MoKVxyXG5cdFx0XHQucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIilcclxuXHJcblxyXG5cclxuXHRcdFx0dmlzaWJsZS5jc3Moe1xyXG5cdFx0XHRcdHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoJHtwb3NpdGlvbn0pYCxcclxuXHRcdFx0XHRcIi13ZWJraXQtdHJhbnNmb3JtXCI6IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259KWBcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRzZXRUaW1lb3V0IChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdGluc2Nyb2xsID0gZmFsc2U7XHJcblxyXG5cdFx0XHRcdCQoXCIuZml4ZWRfX21lbnUtaXRlbVwiKVxyXG5cdFx0XHRcdC5lcShzZWN0aW9uRXEpXHJcblx0XHRcdFx0LmFkZENsYXNzKFwiLmFjdGl2ZVwiKVxyXG5cdFx0XHRcdC5zaWJsaW5ncygpXHJcblx0XHRcdFx0LnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG5cdFx0XHR9LDEwMDApO1xyXG5cclxuXHRcdH1cclxuXHR9XHJcblx0XHRcclxuXHJcblx0XHRsZXQgZGVmaW5lU2VjdGlvbnMgPSBmdW5jdGlvbihzZWN0aW9uc0xpc3Qpe1xyXG5cclxuXHRcdFx0bGV0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9uc0xpc3QuZmlsdGVyKFwiLmlzLWFjdGl2ZVwiKTtcclxuXHRcdFx0cmV0dXJue1xyXG5cdFx0XHRcdGFjdGl2ZVNlY3Rpb246IGFjdGl2ZVNlY3Rpb24sXHJcblx0XHRcdFx0bmV4dFNlY3Rpb246IGFjdGl2ZVNlY3Rpb24ubmV4dCgpLFxyXG5cdFx0XHRcdHByZXZTZWN0aW9uOiBhY3RpdmVTZWN0aW9uLnByZXYoKVxyXG5cclxuXHRcdFx0fTtcclxuXHRcdH07XHJcblxyXG5cdFx0bGV0IHNjcm9sbFRvU2VjdGlvbiA9IGZ1bmN0aW9uKGRpcmVjdGlvbil7XHJcblx0XHRcdGxldCBzZWN0aW9uID0gZGVmaW5lU2VjdGlvbnMoc2VjdGlvbnMpO1xyXG5cdFx0XHRpZiAoZGlyZWN0aW9uID09IFwidXBcIiAmJiBzZWN0aW9uLm5leHRTZWN0aW9uLmxlbmd0aCl7XHJcblx0XHRcdFx0cGVyZm9ybVRyYW5zaXRpb24oc2VjdGlvbi5uZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGRpcmVjdGlvbiA9PSBcImRvd25cIiAmJiBzZWN0aW9uLnByZXZTZWN0aW9uLmxlbmd0aCl7XHJcblx0XHRcdFx0cGVyZm9ybVRyYW5zaXRpb24oc2VjdGlvbi5wcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdH07XHJcblxyXG5cdFx0JChcIi53cmFwcGVyXCIpLm9uKHtcclxuXHRcdFx0d2hlZWw6IGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG5cdFx0XHRcdGNvbnN0IGRpcmVjdGlvbiA9IGRlbHRhWSA+IDAgPyBcInVwXCIgOiBcImRvd25cIjtcclxuXHJcblx0XHRcdFx0c2Nyb2xsVG9TZWN0aW9uKGRpcmVjdGlvbik7XHJcblx0XHRcdH0sXHJcblx0XHRcdHRvdWNobW92ZTogZSA9PiBlLnByZXZlbnREZWZhdWx0KClcclxuXHRcdH0pO1xyXG5cdFx0aWYgKGlzTW9iaWxlKXtcclxuXHRcdFx0JCh3aW5kb3cpLnN3aXBlKHtcclxuXHRcdFx0XHRzd2lwZTogKGV2ZW50LGRpcmVjdGlvbikgPT57XHJcblx0XHRcdFx0XHRzY3JvbGxUb1NlY3Rpb24oZGlyZWN0aW9uKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHR9XHJcblxyXG4gICAgICAgIFxyXG5cclxuXHJcblx0Ly9cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXJyb3ctc2Nyb2xsXCIpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHQvL1x0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0Ly9cdFx0cGVyZm9ybVRyYW5zaXRpb24oMSk7XHJcblx0Ly9cdH0pXHJcbiAgICQoXCJbZGF0YS1zY3JvbGwtdG9dXCIpLm9uKFwiY2xpY2tcIiwgZSA9PiB7XHJcblx0ICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdCAgIHBlcmZvcm1UcmFuc2l0aW9uKHBhcnNlSW50KCQoZS50YXJnZXQpLmRhdGEoXCJzY3JvbGwtdG9cIikpKTtcclxuICAgfSlcclxuXHJcblxyXG5cdH1cclxuXHRPbmVQYWdlU2Nyb2xsKCk7XHJcbn0pO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==
